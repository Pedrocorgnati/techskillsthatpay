# I18N Architecture

- Supported locales: `en`, `pt`, `es`, `it` (`lib/i18n.ts`). `defaultLocale = en`.
- URL structure: all routes are prefixed with the locale: `/en/...`, `/pt/...`, `/es/...`, `/it/...`.
- Middleware (`middleware.ts`):
  - Detects locale via cookie `locale`, then `Accept-Language`, fallback `en`.
  - Redirects any non-prefixed route to `/{detectedLocale}` (307). Ignores `_next`, `api`, and static files.
- Routing:
  - Pages live under `app/[lang]/...` (home, posts, category, tag, search, about, privacy, disclosure, contact, courses, categories).
  - Root `app/page.tsx` redirects to `/en`.
- Language switcher (`components/LanguageSwitcher.tsx`):
  - Client-side switch updates cookie `locale` (1 year) and swaps the locale segment of the current path.
  - Falls back to locale home if path doesnâ€™t exist after switching (handled by router 404).
- Data:
  - Content stored per-locale under `content/posts/{locale}/`.
  - `lib/posts.ts` loads MDX per locale; posts carry `locale`, `translationKey`, `author`, and other frontmatter.
  - Helpers: locale-scoped `getAllPosts(locale?)`, `getAllCategories(locale?)`, `getAllTags(locale?)`, and `getTranslationsFor(translationKey)`.
- SEO:
  - Layout adds `lang` attribute; per-page metadata uses canonical + hreflang alternates for locales.
  - JSON-LD `BlogPosting` includes `inLanguage`.
  - Sitemap (`app/sitemap.ts`) lists all locales for static pages, posts, categories, tags.
- Theme/layout:
  - Header/Footer use current locale for navigation links and include theme toggle + language switcher.
