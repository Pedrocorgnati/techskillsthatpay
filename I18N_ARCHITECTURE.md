# I18N Architecture

- Supported locales: `en`, `pt`, `es`, `it` (`lib/i18n.ts`). `defaultLocale = en`.
- Domain routing (`lib/domainRouting.ts`):
  - en → `techskillsthatpay.com`
  - pt → `techskillsthatpay.com.br`
  - es → `techskillsthatpay.es`
  - it → `techskillsthatpay.it`
  - Override with `DOMAIN_*` / `NEXT_PUBLIC_DOMAIN_*`.
- URL structure:
  - Production domains use clean paths (no locale prefix).
  - Internal routes remain under `app/[lang]/...` and are reached via middleware rewrite.
- Middleware (`middleware.ts`):
  - If host is a mapped domain: rewrite `/{path}` → `/{locale}/{path}`.
  - If path already has a locale prefix, redirect to clean URL (301).
  - If host is localhost/unknown: keep path-based locale behavior with cookie/Accept-Language fallback.
- Routing:
  - Pages live under `app/[lang]/...` (home, posts, category, tag, search, about, privacy, disclosure, contact, courses, categories).
  - Root `app/page.tsx` redirects to `/en`.
- Language switcher (`components/LanguageSwitcher.tsx`):
  - Client-side switch updates cookie `locale` (1 year) and swaps the locale segment of the current path.
  - Falls back to locale home if path doesn’t exist after switching (handled by router 404).
- Data:
  - Content stored per-locale under `content/posts/{locale}/`.
  - `lib/posts.ts` loads MDX per locale; posts carry `locale`, `translationKey`, `author`, and other frontmatter.
  - Helpers: locale-scoped `getAllPosts(locale?)`, `getAllCategories(locale?)`, `getAllTags(locale?)`, and `getTranslationsFor(translationKey)`.
- SEO:
  - Layout adds `lang` attribute; per-page metadata uses domain-aware canonical + hreflang alternates.
  - JSON-LD `BlogPosting` includes `inLanguage`.
  - Sitemap (`app/sitemap.ts`) lists all locales for static pages, posts, categories, tags.
- Theme/layout:
  - Header/Footer use current locale for navigation links and include theme toggle + language switcher.
